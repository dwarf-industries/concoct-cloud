<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Essential JS 1 :UML Activity Diagram</title>
    <link href="../content/bootstrap.min.css" rel="stylesheet" />
    <link href="../content/ejthemes/default-theme/ej.web.all.min.css" rel="stylesheet" />
    <link href="../content/default.css" rel="stylesheet" />
    <link href="../content/default-responsive.css" rel="stylesheet" />
    <link href="../images/diagram/symbolpalette/symbolpalette.css" rel="stylesheet" />
    <!--[if lt IE 9]>
         <script src="../scripts/jquery-1.11.3.min.js" type="text/javascript"></script>
     <!--<![endif]-->
    <!--[if gte IE 9]><!-->
    <script src="../scripts/jquery-3.3.1.min.js" type="text/javascript"></script>
    <!--<![endif]-->
    <script src="../scripts/ej.web.all.min.js"></script>
    <script src="../scripts/jsrender.min.js"></script>
    <script src="../scripts/properties.js" type="text/javascript"></script>
    <script src="../scripts/diagramscripts/diagramcommon.js"></script>
</head>
<body>
    <div class="content-container-fluid">
        <div class="row">
            <div class="cols-sample-area">
                <div class="control_section">
                    <div class="symPalette_section">
                        <div id="symbolpalette">
                        </div>
                    </div>
                    <div class="middle_section"></div>
                    <div class="diagram_section">
                        <div id="diagram"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        var ports = [{
            name: "in", offset: { x: 0.13, y: 0.5 },
            shape: "circle",
            visibility: ej.datavisualization.Diagram.PortVisibility.Visible,
            fillColor: "red"
        },
        {
            name: "inn",
            offset: { x: 0.85, y: 0.5 },
            shape: "circle",
            visibility: ej.datavisualization.Diagram.PortVisibility.Visible,
            fillColor: "red"
        }];

        var ports1 = [{ name: "in1", offset: { x: 0, y: 0.5 }, shape: "circle" },
                     { name: "in2", offset: { x: 1, y: 0.5 }, shape: "circle" },
        ];

        var palettes = [{
            name: "UML Activity Shapes",
            expanded: true,
            items: [
                {
                    name: "AcceptingEvent", width: 80, height: 50, offsetX: 70 / 2, offsetY: 45 / 2,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.AcceptingEvent,
                    title: "Accepting Event"
                },
                {
                    name: "Action", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
                },
                {
                    name: "SendSignal", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.SendSignal
                },
                {
                    name: "MergeNode", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.MergeNode
                },
                {
                    name: "Decision", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.Decision
                },
                {

                    name: "FinalNode", width: 70, height: 70, offsetX: 35, offsetY: 35,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.FinalNode
                },
                {
                    name: "JoinNode", width: 90, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.JoinNode,
                },
                {
                    name: "ForkNode", height: 90, width: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.ForkNode,
                },
                {
                    name: "InitialNode", width: 70, height: 70, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.InitialNode
                },
                {
                    name: "TimeEvent", width: 50, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.TimeEvent
                },

                {
                    name: "ReceiveSignal", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.ReceiveSignal
                },
                {
                    name: "StructuredNode", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    labels: [{ text: "Structured Node" }],
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.StructuredNode
                },
                {
                    name: "Note", width: 80, height: 50, offsetX: 20, offsetY: 20,
                    type: "umlactivity",
                    shape: ej.datavisualization.Diagram.UMLActivityShapes.Note
                }
            ]
        }];

        var nodes = [

              {
                  name: "node1", width: 50, height: 50, offsetX: 390, offsetY: 40,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.InitialNode,
              },
              {
                  name: "node2", width: 100, height: 50, offsetX: 390, offsetY: 130,
                  labels: [{ text: "Establish E-mail Communication" }],
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
              },
              {
                  name: "node3", width: 340, height: 5, offsetX: 390, offsetY: 200,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.ForkNode, ports: ports
              },
              {
                  name: "node4", width: 80, height: 50, offsetX: 264, offsetY: 270,
                  labels: [{ text: "Send Email" }],
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
              },
              {
                  name: "node5", width: 80, height: 50, offsetX: 510, offsetY: 270,
                  labels: [{ text: "Receive Response" }],
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
              },
              {
                  name: "node6", width: 60, height: 60, offsetX: 264, offsetY: 360,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.MergeNode, ports: ports1
              },
              {
                   name: "node7", width: 80, height: 50, offsetX: 185, offsetY: 450,
                   labels: [{ text: "Encrypted Email" }],
                   type: "umlactivity",
                   shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
              },
              {
                  name: "node8", width: 80, height: 50, offsetX: 340, offsetY: 450,
                  labels: [{ text: "Regular Email" }],
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
              },
              {
                  name: "node9", width: 60, height: 60, offsetX: 264, offsetY: 540,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.MergeNode, ports: ports1
              },
              {
                  name: "node10", width: 50, height: 50, offsetX: 510, offsetY: 450,
                  labels: [{
                      "text": "Wait 2 hours after send", offset: {
                          x: 1,
                          y: 0.5
                      },
                      margin:{left:-5},
                      horizontalAlignment:"left"
                  }],
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.TimeEvent
              },
              {
                  name: "node11", width: 60, height: 60, offsetX: 510, offsetY: 540,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.MergeNode
              },
              {
                  name: "node11a", width: 50, height: 50, offsetX: 650, offsetY: 540,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.FinalNode
              },
              {
                  name: "node12", width: 340, height: 5, offsetX: 388.74, offsetY: 617.5,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.ForkNode, ports: ports
              },
              {
                  name: "node13", width: 100, height: 50, offsetX: 388, offsetY: 690,
                  labels: [{ text: "Communication Established" }],
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.Action
              },
              {
                  name: "node14", width: 50, height: 50, offsetX: 388, offsetY: 765,
                  type: "umlactivity",
                  shape: ej.datavisualization.Diagram.UMLActivityShapes.FinalNode
              },
        ];

        var connectors =
            [
                { name: "connector1", sourceNode: "node1", targetNode: "node2" },
                { name: "connector2", sourceNode: "node2", targetNode: "node3" },
                { name: "connector3", sourceNode: "node3", targetNode: "node4", sourcePort: "in", segments: [{ "type": "straight" }] },
                { name: "connector4", sourceNode: "node3", targetNode: "node5", sourcePort: "inn", segments: [{ "type": "straight" }] },
                { name: "connector5", sourceNode: "node4", targetNode: "node6" },
                {
                    name: "connector6", sourceNode: "node6", targetNode: "node7", sourcePort: "in1", segments: [{ "type": "orthogonal" }],
                    shape: { type: "umlactivity", activityFlow: "objectflow" }, labels: [{ "text": "[Private content]", fillColor:"white" }]
                },
                {
                    name: "connector7", sourceNode: "node6", targetNode: "node8", sourcePort: "in2", segments: [{ "type": "orthogonal" }],
                    shape: { type: "umlactivity", activityFlow: "objectflow" }, labels: [{ "text": "[else]", fillColor:"white" }]
                },
                {
                    name: "connector8", sourceNode: "node7", targetNode: "node9", segments: [{ "type": "orthogonal" }],
                    shape: { type: "umlactivity", activityFlow: "controlflow" }, targetPort: "in1"
                },
                { name: "connector9", sourceNode: "node8", targetNode: "node9", segments: [{ "type": "orthogonal" }], targetPort: "in2" },
                { name: "connector10", sourceNode: "node5", targetNode: "node10" },
                { name: "connector11", sourceNode: "node10", targetNode: "node11" },
                { name: "connector12", sourceNode: "node9", targetNode: "node12", targetPort: "in", segments: [{ "type": "straight" }] },
                { name: "connector13", sourceNode: "node11", targetNode: "node12", labels: [{ "text": "Valid reply", fillColor:"white", segmentOffset:0.4 }], targetPort: "inn", segments: [{ "type": "straight" }] },
                { name: "connector14", sourceNode: "node12", targetNode: "node13", },
                { name: "connector15", sourceNode: "node13", targetNode: "node14" },
                { name: "connector16", sourceNode: "node11", targetNode: "node11a", labels: [{ "text": "[no reply] || [error]" }] },
            ];

        $(function () {

            $("#symbolpalette").ejSymbolPalette({
                diagramId: "diagram",
                palettes: palettes,
                height: "600px", width: "100%",
                paletteItemWidth: 50, paletteItemHeight: 50,
                previewWidth: 100, previewHeight: 100,
                showPaletteItemText: false,
            });

            $("#diagram").ejDiagram({
                height: "600px", width: "100%", nodes: nodes,
                connectors: connectors,
                pageSettings: { scrollLimit: "diagram" },
                snapSettings: { snapConstraints: ej.datavisualization.Diagram.SnapConstraints.None },
                defaultSettings: {
                    node: {
                        borderColor: "black", labels: [{ "fontColor": "black" }]
                    }
                },
            });
            setToolTip(true);
        });

        function setToolTip(isLoad) {
            var paletteItems;
            if (isLoad)
                paletteItems = $(".e-paletteItem");
            for (m = 0; m < paletteItems.length; m++) {
                var title = "";
                var wWord = ((paletteItems[m].id).split("_")[0]);
                if (wWord) {
                    if (wWord.split(/(?=[A-Z])/)[0])
                        title += " " + wWord.split(/(?=[A-Z])/)[0];
                    if (wWord.split(/(?=[A-Z])/)[1])
                        title += " " + wWord.split(/(?=[A-Z])/)[1];
                    if (wWord.split(/(?=[A-Z])/)[2])
                        title += " " + wWord.split(/(?=[A-Z])/)[2];
                    if (wWord.split(/(?=[A-Z])/)[3])
                        title += " " + wWord.split(/(?=[A-Z])/)[3];
                    if (wWord.split(/(?=[A-Z])/)[4])
                        title += " " + wWord.split(/(?=[A-Z])/)[4];
                }
                paletteItems[m].setAttribute("title", title);
            }
        }

    </script>
    <style>
        .control_section {
            height: 600px;
            width: 100%;
            background-color: transparent;
        }

        .diagram_section {
            width: calc(100% - 235px);
            height: 100%;
            float: left;
        }

        .middle_section {
            float: left;
            width: 5px;
            height: 100%;
        }

        .symPalette_section {
            width: 230px;
            height: 100%;
            float: left;
        }
    </style>


</body>
</html>	